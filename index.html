<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>VR Quiz App</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Carregar a imagem panoramica -->
      <a-sky id="fundo" src="carata.jpg" rotation="0 -130 0"></a-sky>

      <!-- Pergunta -->
      <a-text id="pergunta" 
              value="Caratateua fica em que Estado?" 
              position="0 2 -3" 
              width="4"
              color="red">
      </a-text>

      <!-- Opcoes de Resposta com planos clicaveis -->
      <a-plane position="-2.5 1.5 -3" width="3.2" height="0.4" opacity="0" class="option" id="opcaoA-plane">
        <a-text value="A) Manaus" color="white" width="4" position="0 0 0.1" id="opcaoA"></a-text>
      </a-plane>

      <a-plane position="2.5 1.5 -3" width="3.2" height="0.4" opacity="0" class="option" id="opcaoB-plane">
        <a-text value="B) Maranhao" color="white" width="4" position="0 0 0.1" id="opcaoB"></a-text>
      </a-plane>

      <a-plane position="-2.5 1 -3" width="3.2" height="0.4" opacity="0" class="option" id="opcaoC-plane">
        <a-text value="C) Para" color="white" width="4" position="0 0 0.1" id="opcaoC"></a-text>
      </a-plane>

      <a-plane position="2.5 1 -3" width="3.2" height="0.4" opacity="0" class="option" id="opcaoD-plane">
        <a-text value="D) Roraima" color="white" width="4" position="0 0 0.1" id="opcaoD"></a-text>
      </a-plane>

      <!-- Botao Reiniciar (inicialmente invisivel) -->
      <a-plane id="reiniciar-plane" position="0 0.5 -3" width="2.5" height="0.5" opacity="0" visible="false">
        <a-text value="Reiniciar" color="yellow" width="3" position="0 0 0.1"></a-text>
      </a-plane>

      <!-- Cursor com animacao de carregamento -->
      <a-entity camera look-controls>
        <a-cursor 
          id="cursor"
          color="yellow"
          fuse="true" 
          fuse-timeout="1000"
          animation__fusing="property: scale; to: 1.5 1.5 1.5; startEvents: fusing; easing: easeInCubic; dur: 1000"
          animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; easing: easeOutCubic; dur: 300">
        </a-cursor>
      </a-entity>
    </a-scene>

    <script>
      const perguntas = [
        {
          pergunta: "Caratateua fica em que Estado?",
          opcoes: ["Manaus", "Maranhao", "Para", "Roraima"],
          correta: 2
        },
        {
          pergunta: "Quantos anos duram, em media, as placas solares mantendo boa eficiencia?",
          opcoes: ["10 anos", "15 anos", "20 anos", "25 anos"],
          correta: 2
        },
        {
          pergunta: "Como funciona a energia termosolar?",
          opcoes: [
            "Transforma o calor do sol em eletricidade diretamente",
            "Usa a luz solar para gerar energia quimica",
            "Transforma a luz do sol em calor e, posteriormente, em energia eletrica",
            "Gera energia a partir de espelhos"
          ],
          correta: 2
        }
      ];

      let perguntaAtual = 0;

      function atualizarPergunta() {
        const pergunta = perguntas[perguntaAtual];
        document.getElementById("pergunta").setAttribute("value", pergunta.pergunta);
        document.getElementById("opcaoA").setAttribute("value", `A) ${pergunta.opcoes[0]}`);
        document.getElementById("opcaoB").setAttribute("value", `B) ${pergunta.opcoes[1]}`);
        document.getElementById("opcaoC").setAttribute("value", `C) ${pergunta.opcoes[2]}`);
        document.getElementById("opcaoD").setAttribute("value", `D) ${pergunta.opcoes[3]}`);
        document.getElementById("opcaoA").setAttribute("color", "white");
        document.getElementById("opcaoB").setAttribute("color", "white");
        document.getElementById("opcaoC").setAttribute("color", "white");
        document.getElementById("opcaoD").setAttribute("color", "white");
      }

      function verificarResposta(opcaoIndex) {
        const respostaCorreta = perguntas[perguntaAtual].correta;
        const idCorreta = ["opcaoA", "opcaoB", "opcaoC", "opcaoD"][respostaCorreta];
        
        if (opcaoIndex === respostaCorreta) {
          document.getElementById(idCorreta).setAttribute("color", "blue");
          document.getElementById(idCorreta).setAttribute("width", "5");
        } else {
          document.getElementById(idCorreta).setAttribute("color", "blue");
          document.getElementById(idCorreta).setAttribute("width", "5");
        }

        setTimeout(() => {
          perguntaAtual++;
          if (perguntaAtual < perguntas.length) {
            atualizarPergunta();
          } else {
            finalizarQuiz();
          }
          document.querySelector('[camera]').setAttribute('rotation', {x: 0, y: 0, z: 0});
        }, 1000);
      }

      function finalizarQuiz() {
        document.getElementById("pergunta").setAttribute("value", "Voce completou todas as perguntas!");
        document.getElementById("fundo").setAttribute("src", "orla.jpg");
        document.getElementById("reiniciar-plane").setAttribute("visible", "true");
      }

      function reiniciarQuiz() {
        perguntaAtual = 0;
        atualizarPergunta();
        document.getElementById("reiniciar-plane").setAttribute("visible", "false");
        document.getElementById("fundo").setAttribute("src", "carata.jpg");
      }

      document.querySelector('#opcaoA-plane').addEventListener('click', function () {
        verificarResposta(0);
      });
      
      document.querySelector('#opcaoB-plane').addEventListener('click', function () {
        verificarResposta(1);
      });

      document.querySelector('#opcaoC-plane').addEventListener('click', function () {
        verificarResposta(2);
      });

      document.querySelector('#opcaoD-plane').addEventListener('click', function () {
        verificarResposta(3);
      });

      document.querySelector('#reiniciar-plane').addEventListener('click', function () {
        reiniciarQuiz();
      });

      atualizarPergunta();
    </script>
  </body>
</html>
